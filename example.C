#include "MyAnalysis.h"
#include "Plotter.h"
#include <iostream>
#include <TChain.h>
#include <TGraphAsymmErrors.h>
#include <string>

int main() {
   
   float lumi = 12900.;
   
   TString dir = "/xrootd/store/user/tjkim/ntuples/hep2016/V4";

   int nevt = -1;

   bool run = true;

   if( run ) {

   MyAnalysis *A = new MyAnalysis();
   TChain* ch = new TChain("TopTree/events");
   ch->Add(Form("%s/hep_data.root",dir.Data()), nevt);
   ch->Process(A,"data");

   MyAnalysis *B = new MyAnalysis(1,1,831.8,lumi);
   TChain* ch2 = new TChain("TopTree/events");
   ch2->Add(Form("%s/hep_TT_powheg.root",dir.Data()), nevt);
   ch2->Process(B,"TT_powheg");

   MyAnalysis *C = new MyAnalysis(1,1,61524,lumi);
   TChain* ch3 = new TChain("TopTree/events");
   ch3->Add(Form("%s/hep_WJets.root",dir.Data()),nevt);
   ch3->Process(C,"WJets");
   
   MyAnalysis *D = new MyAnalysis(1,1,6025.2,lumi);
   TChain* ch4 = new TChain("TopTree/events");
   ch4->Add(Form("%s/hep_DYJets.root",dir.Data()),nevt);
   ch4->Process(D,"DYJets");

   MyAnalysis *E = new MyAnalysis(1,1,18610.0,lumi);
   TChain* ch5 = new TChain("TopTree/events");
   ch5->Add(Form("%s/hep_DYJets_10to50.root",dir.Data()),nevt);
   ch5->Process(E,"DYJets_10to50");
 
   MyAnalysis *F = new MyAnalysis(1,1,44.33,lumi);
   TChain* ch6 = new TChain("TopTree/events");
   ch6->Add(Form("%s/hep_SingleTop_t.root",dir.Data()),nevt);
   ch6->Process(F,"SingleTop_t");

   MyAnalysis *J = new MyAnalysis(1,1,26.38,lumi);
   TChain* ch7 = new TChain("TopTree/events");
   ch7->Add(Form("%s/hep_SingleTbar_t.root",dir.Data()),nevt);
   ch7->Process(J,"SingleTbar_t");

   MyAnalysis *K = new MyAnalysis(1,1,35.6,lumi);
   TChain* ch8 = new TChain("TopTree/events");
   ch8->Add(Form("%s/hep_SingleTop_tW.root",dir.Data()),nevt);
   ch8->Process(K,"SingleTop_tW");

   MyAnalysis *L = new MyAnalysis(1,1,35.6,lumi);
   TChain* ch9 = new TChain("TopTree/events");
   ch9->Add(Form("%s/hep_SingleTbar_tW.root",dir.Data()),nevt);
   ch9->Process(L,"SingleTbar_tW");

   }

   Plotter P;

   P.SetData("hist_data.root", std::string("Data"));
   P.AddBg("hist_TT_powheg.root", std::string("t#bar{t}"));
   P.AddBg("hist_WJets.root", std::string("W #rightarrow l#nu"));
   P.AddBg("hist_DYJets.root", std::string("Z/#gamma* #rightarrow ll"));
   P.AddBg("hist_DYJets_10to50.root", std::string("Z/#gamma* #rightarrow ll (10-50)"));
   P.AddBg("hist_SingleTop_t.root", std::string("Single Top_t"));
   P.AddBg("hist_SingleTbar_t.root", std::string("single Tbar-t"));
   P.AddBg("hist_SingleTop_tW.root", std::string("single Top-tW"));
   P.AddBg("hist_SingleTbar_tW.root", std::string("single Tbar-tW"));
 
   P.Plot("results.pdf");

}
